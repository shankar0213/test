	  
	  When PRTY_TYPE_CD = 'I'
1. If PROFILE_ID is not null, use PROFILE_ID to join to SRC_KEY2 in C_PSEUDO_PRTY (where DATA_SRC = 'ICM' and SOURCE_COUNTRY_CODE = 'ID') and load CONCAT (DATA_SRC, '-', SOURCE_COUNTRY_CODE, '-',PSEUDO_KEY) as ENTRP_PRTY_SROGT_ID
2. If PROFILE_ID is null, then ENTRP_PRTY_SROGT_ID = null

When PRTY_TYPE_CD <> 'I', sort record by MAST_OPEN_DT descending, DOM_MAST_REF and LE_ID, and group record by PRTY_SROGT_ID:
1. If all records have DOM_MAST_REF as null, then load ENTRP_PRTY_SROGT_ID = null
2. If DOM_MAST_REF is not null, select the record with latest MAST_OPEN_DT and LE_ID not null,
       - use CONCAT(TRIM(LE_ID), '-', TRIM(SP_ID)) to join to SRC_KEY1 in  C_PSEUDO_PRTY (where DATA_SRC = 'SCI' and SOURCE_COUNTRY_CODE = 'XX') and load  CONCAT (DATA_SRC, '-', SOURCE_COUNTRY_CODE, '-',PSEUDO_KEY) as ENTRP_PRTY_SROGT_ID.
       - if all records have null LE_ID then ENTRP_PRTY_SROGT_ID = null	   
3. If WEP.CLIENTID IS NULL, select the record with latest MAST_OPEN_DT and LE_ID not null,
       - use CONCAT(TRIM(LE_ID), '-', TRIM(SP_ID)) to join to SRC_KEY1 in  C_PSEUDO_PRTY (where DATA_SRC = 'SCI' and SOURCE_COUNTRY_CODE = 'XX') and load  CONCAT (DATA_SRC, '-', SOURCE_COUNTRY_CODE, '-',PSEUDO_KEY) as ENTRP_PRTY_SROGT_ID.
       - if all records have null LE_ID then ENTRP_PRTY_SROGT_ID = null	  


---------------------------------------------------------